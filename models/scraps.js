const slug =["Teremok_Nikolskaya",
    "Coffeemania_Kutuzovskiy",
    "mcd_sove2",
    "Hachapuri_gnezdikovskiy1",
    "tanuki_borprud",
    "christian_msk",
    "marivanna_msc",
    "vokker_pro",
    "Prime_Pokryshkina4",
    "BurgerFries_Mir",
    "Menza_Vernadskogo105",
    "tripravila_michurinski",
    "Yakitoriya",
    "HlebNasushchnyj_Smolenskiy",
    "ilpto",
    "Taras_bulba_nd",
    "pripek-depo",
    "pizza_hut_kolom",
    "almaz_shashlichnaya",
    "bocconcino-patriarshiy",
    "paul-arbata",
    "Burger_Heroes_arbat",
    "elardji",
    "KetchUp_kuznetsky",
    "AnderSon_Ostro",
    "pomodoro_royal_paveleckaya1",
    "dag_Bratislavskaya",
    "UpsideDownCakekash",
    "john_dzholi_nd_nikoloyamskaya",
    "steak_it_easy_arbat",
    "Subway_novodmit",
    "gorodsadkras",
    "PapaJohns_32",
    "burgerpizzetta_vegas",
    "Food_Band_Liha4",
    "BlackStarBurger_Myasnitskaya",
    "Niyama_Vernadskogo",
    "Pinsa_Maestrello",
    "PizzaPi_Vorontsovskaya",
    "Marukame_avtozavodskaya",
    "PhoPoint",
    "Akademia_Novinskiy",
    "Black_Thai",
    "CheapsideJosperBistro",
    "Kitayskienovosti-Spiridon",
    "BlackMarket",
    "Zodiac",
    "fresh_mitnaya",
    "mjaso_ryba_yarcevskaya",
    "demarko_mayakovka",
    "hite",
    "ChaihonaN1_Novoslobodskaya",
    "Zotman",
    "TrueBurgers_Leninskiy",
    "varlamovyest-lenin",
    "chaihona7_mp",
    "varenichnaya1_myasnitskaya",
    "andiamo_vernadskogo",
    "phohanoi",
    "MuMu_Lyublinskaya",
    "VaiMe_Pyatnickay",
    "morocco_depo",
    "Sushi_Shop_mayak",
    "dedgruzii8",
    "surfcoffee_mayak",
    "greekstreet_moscow",
    "Balifornia",
    "planeta_sushi_inter",
    "tgi_msk_pavel",
    "china_depo",
    "grupy_kavkaz",
    "mollusca_lesnaya",
    "depo_cheesemania",
    "the_truffle",
    "crema_eclair",
    "mama_budet_rada",
    "shikari_horoshevskoe27",
    "tar_tar",
    "three_ducks",
    "BrightIsraeliGrillDepo",
    "cinnabon2",
    "didi_ginza",
    "Love_and_Sweets",
    "lamyan",
    "patara",
    "milanpizza",
    "Camorra_msk",
    "butler",
    "bushe-torti-teatralniy",
    "caprisepizza",
    "barnikolai2",
    "SushiWok1",
    "produkty",
    "kitchen_koupes",
    "los_medv",
    "Pyan-Se-Maroseyka",
    "Batoni_Sportivnaya",
    "LaffaLaffa",
    "Buloshnaja-Jitnaya",
    "Cheretto_Tsvetnoy",
    "Corner_Burger_Gruzinskaya",
    "Torro-grill-Paveletskaya",
    "china_club",
    "Meat-Me",
    "Brix",
    "VietCafe_Vernadskogo",
    "rassolnikovmira",
    "Point_Coffee",
    "miminomsk",
    "Est_hinkali_pit_vino_ostojenka",
    "Osteria_Mario_Khimki1",
    "TheHummus_NKrasnoselskaya",
    "IchibanBoshiYakimanka",
    "Limoncino",
    "Kitayskaya_gramota",
    "ExtraVirgin",
    "Hochu_hichin",
    "Kreperi_de_Pari",
    "Voronezh_na_Dmitrovke",
    "Bochka",
    "Cafe_Pushkin",
    "IlForno_Neglinnaya",
    "Jiest",
    "Guliani",
    "Kimchi_RevolutionSq",
    "TheBurgerBrothers",
    "RodnuyeLuydi",
    "Ess-Thetik",
    "DonGiulioPasticceria",
    "MaximaPizza",
    "KrylyshkoorNozhka",
    "Mushrooms",
    "ChinChin-VMaslovka",
    "Osteriya-u-Salvatore",
    "DolmaSretenka",
    "MrLivanets",
    "GinNoTaki12",
    "Matsoni_Novokuznetskaya",
    "BQ_Khimki",
    "Hinkalnaya_Gogolevskiy",
    "Deli_Marche",
    "Paprikolli",
    "Kabanchik",
    "Fornetto_Frunze",
    "Nam",
    "Vinnii_Bufet",
    "Greatsushi",
    "Ryba_International",
    "Corner_Kitchen_Cafe",
    "Mandarin-Lapsha_i_Utki",
    "Turandot",
    "Dobrynya",
    "Have_A_Nice_Day",
    "Xarcho-Puri",
    "Beyrut",
    "HaggisPub_Petrovka",
    "MadameWong",
    "Barashka",
    "Bardak",
    "Horosheedelo",
    "Italianrest",
    "ZingerGrill",
    "Receptor-BKozikhinsky",
    "easypub_angel",
    "Ramen-pyatnickaya",
    "pastadeli_mozhaiskiy",
    "Timur",
    "Luciano",
    "Perez_and_Myata",
    "Farengeit",
    "ChurchillsPub",
    "PirogovayaRogova",
    "Dom-Cafe",
    "bebijoli",
    "Professor_Puf",
    "Provance",
    "Sok",
    "Makoto",
    "T-bon-PrMira",
    "Sindbad",
    "Giovedi",
    "Bruce_Lee_Zvenigorodskaya",
    "shafran_mezhdunarodnaya",
    "hinkalna47",
    "maranigar",
    "Hachapuria",
    "Lusun",
    "LaScarpetta",
    "Gogieli",
    "Shinok",
    "Staraya-mansarda",
    "samarkand_otk",
    "burcho_nd",
    "fermaburger_21",
    "La_Taverna",
    "hatsatun",
    "gayanes2",
    "Buyabes",
    "Noev-Kovcheg",
    "19Bar"]
const fs = require('fs');
const fetch = require('node-fetch');

class getDataRestorants  {
    constructor(url) {
        this.url = url;
        this.count= 0;
    }

    async getRestaurantDescription(name) {
        try{
            let response =  await fetch(`${this.url}/${name}?regionId=1`);
            return await response.json();
        } catch(error) {
            throw new Error('Не получилось получить данные ресторана')
        }
    }

    async getRestaurantMenu(name) {
        try{
            let response =  await fetch(`${this.url}/${name}/menu?regionId=1`);
            return await response.json();
        } catch(error) {
            throw new Error('Не получилось получить меню ресторана')
        }
    }

    async comment(index) {
        console.log('index -' + index)
        let description = await this.getRestaurantDescription(slug[index]);
        let menu = await this.getRestaurantMenu(slug[index]);


        fs.writeFile(`./records/${slug[index]}.json`, JSON.stringify({description, menu}) ,
            (err) =>{
                if(err) {
                    console.log(err)
                    return
                }

                console.log('OK -' + this.count)

            });
        this.count = this.count + 1

        if (this.count === slug.length) {
            return 'DONE'
        } else {
            return index + 1
        }

    };
}

module.exports = new getDataRestorants("https://eda.yandex/api/v2/catalog");


//https://eda.yandex/api/v2/catalog/Teremok_Nikolskaya/menu?regionId=1

//https://eda.yandex/api/v2/catalog/Teremok_Nikolskaya?regionId=1